# Repository Distiller Configuration
# ---------------------------------------------------------------------------
# This configuration is designed for a whitelist-first, "Priority Cascade" model:
#   Tier 1: whitelist.files           (Golden Ticket / force include)
#   Tier 2: blacklist.files/patterns  (Explicit veto / force exclude)
#   Tier 3: whitelist.directories    (Scope gate for whitelist-only safety)
#   Tier 4: general exclusions        (dirs/ext/size) applied after Tier 3
#
# Notes:
# - Regex patterns in YAML should use SINGLE QUOTES to avoid escape issues.
# - Glob patterns are evaluated against repository-relative POSIX paths (forward slashes).
# ---------------------------------------------------------------------------

# AI coding environment: used only for reporting/metadata in logs
ai_coding_env: 'chat'

# General file-size cap (MB) applied at Tier 4 (after directory scope),
# and bypassed for Tier 1 explicit file whitelists.
max_file_size_mb: 5

# ============================================================================
# WHITELIST RULES
# ============================================================================
whitelist:
  # Tier 1 "Golden Ticket" file includes. These are force-included even if they
  # live under a generally blacklisted directory or exceed max_file_size_mb.
  files:
    - "README.md"
    - "LICENSE"
    - "pyproject.toml"
    - "requirements.txt"
    - "config.yaml"
    - "src/repo_distiller.py"
    - "docs/tech-specs.md"
    - "docs/user-manual.md"

  # Tier 3 scope directories. Files must be inside at least one of these
  # directories unless they are included via Tier 1 whitelist.files.
  directories:
    - "src/"
    - "docs/"
    - "tests/"

# ============================================================================
# BLACKLIST RULES
# ============================================================================
blacklist:
  # Tier 2 explicit veto files (exact/glob match)
  files:
    - ".env"
    - ".env.*"
    - ".DS_Store"
    - "poetry.lock"
    - "package-lock.json"
    - "yarn.lock"

  # Tier 2 case-insensitive filename substring vetoes
  # IMPORTANT: This is a raw "contains" match against the filename (not path).
  # Example: "my_BACKUP_notes.txt" will be skipped.
  #
  # WARNING: Short tokens like "BU" are intentionally broad and can match
  # unexpectedly (e.g., "build"). If that becomes noisy, remove or replace with
  # a longer token in your local config.
  filename_substrings:
    - "BACKUP"
    - "BU"
    - "OLD"
    - "ORIGINAL"
    - "INITIAL"

  # Tier 2 datetime-stamp filename veto (YYYYMMDD). When true, any filename
  # containing a valid calendar date like "20251207" will be skipped.
  datetime_stamp_yyyymmdd: true

  # Tier 2 regex filename patterns (evaluated against filename only)
  # Use SINGLE QUOTES.
  patterns:
    - '_v\d{1,2}\.py$'
    - '^step\d{1,2}'
    - '^utils_'
    - '_backup\d*\.'
    - '\.bak$'
    - '~$'

  # Tier 4 extension exclusions (applied only after Tier 3 directory scope)
  extensions:
    - ".png"
    - ".jpg"
    - ".jpeg"
    - ".gif"
    - ".bmp"
    - ".ico"
    - ".svg"
    - ".pdf"
    - ".log"
    - ".tmp"
    - ".cache"
    - ".pyc"
    - ".pyo"
    - ".pyd"
    - ".so"
    - ".dll"
    - ".exe"
    - ".bin"
    - ".zip"
    - ".tar"
    - ".gz"
    - ".7z"
    - ".rar"

  # Tier 4 directory exclusions (applied only after Tier 3 directory scope)
  directories:
    - ".git/"
    - "__pycache__/"
    - ".pytest_cache/"
    - ".mypy_cache/"
    - ".tox/"
    - ".venv/"
    - "venv/"
    - "env/"
    - "node_modules/"
    - "dist/"
    - "build/"
    - "*.egg-info/"

# ============================================================================
# DATA SAMPLING
# ============================================================================
data_sampling:
  enabled: true

  # Structured / semi-structured formats eligible for sampling.
  target_extensions:
    - ".csv"
    - ".tsv"
    - ".json"
    - ".jsonl"

  # CSV/TSV: keep first row as header
  include_header: true

  # Head/tail sizes (rows for CSV/TSV; objects for JSON array; lines for JSONL)
  head_rows: 5
  tail_rows: 5
